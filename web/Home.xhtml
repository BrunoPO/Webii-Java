<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
<title>Smdrive</title><link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
</h:head>

<body>
	
<div id="pagina_home">    
    <header>

        <section id="logo">
            <a href="#"><img src="img/recorte.png" alt="smdrive" /></a>
        </section>
        <section id="busca">                      
            <form>            	
                <input type="text" />
            </form>          
         </section> 
        <section id="pt2">		
            <div id="buttonNovo" style="margin-right:0px">
                <a href="javascript:void(null);" class="myButton" onclick="novoArquivo()"> Novo Arquivo </a> 
                <h:form enctype="multipart/form-data" style="display: none">
                    <h:inputFile class="inputFile" value="#{loginBean.file}">
                        <f:ajax listener="#{loginBean.upload}" render="@all" />
                    </h:inputFile>
                </h:form>
            </div>
            <section id="caminho" style="margin-left:4.3%">
            <h:form>
                <h1>
                <ui:repeat value="#{loginBean.migalha}" var="item">
                    <h:commandLink value="#{item.getNome()}" action="#{loginBean.interacao(item)}" />>
                </ui:repeat> 
                </h1>
            </h:form>	
            <!--h1 align=""><a href="#">Documentos</a>&gt;<a href="#">1</a>&gt;<a href="#">2</a>&gt;<a href="#">3</a></h1-->
            </section>
        </section>

    </header>
        
    <div id="header" />
    <section id="corpo">
        <section id="menu">
            <nav>
                <a href="#">
                    <div class="icon">
                        <img src="img/folder.svg" alt="" />
                    </div>  
                    <p> Documentos</p>                         
                </a><br />
		<a href="#">
                    <div class="icon">
                        <img src="img/folder-account.svg" alt="" />
                    </div>
                    <p> Compartilhado comigo </p>
                </a><br />
            </nav>
	</section>
	<section id="body">	
            <div id="Lista1">				
                <p id="titulo"> Pastas</p>
                <table border="0"><h:form>
                    <tbody>
                        <tr>
                            <td>
                                <h:commandLink action="#{loginBean.back()}">
                                    <div id="icon">
                                        <img src="img/folder.svg" alt="" />
                                    </div>      
                                    <p>...</p>
                                </h:commandLink>
                            </td>
                            <ui:repeat value="#{loginBean.arquis}" var="item">
                            <ui:fragment rendered="#{item.IsPasta()}">
                            <td class="clickebleTd">
                                <input type="checkbox" style="display:none"></input>
                                <h:commandLink class="select" action="#{loginBean.interacao(item)}" style="display:none" />
                                <h:commandButton class="delete" action="#{loginBean.deleta(item)}" style="display:none" />
                                <div id="icon">
                                        <img src="img/folder.svg" alt="" />
                                    </div>                           
                                <p>#{item.getNome()}</p>
                                
                            </td>
                            </ui:fragment> 
                            </ui:repeat>
                            <td>
                                <a href="#" onclick="novaPasta()">
                                    <div id="icon">
                                        <img src="img/folder-plus.svg" class="icon" alt="" />
                                    </div>      
                                    <p>Nova Pasta</p>
                                </a>
                                <h:inputText class="NomePastaAddInput" value="#{loginBean.nomePastaAdd}" style="display: none;"/>
                                <h:commandButton class="NomePastaAddButton" id="hdnBtn" actionListener="#{loginBean.novaPasta()}" style="display: none;" />
                            </td>
                        </tr>
                    </tbody>
                </h:form></table>
                <div id="lista 2">
                <p id="titulo"> Arquivos</p>
                <table border="0">             		
                    <tbody>
                        <tr>
                            <h:form>
                            <ui:repeat value="#{loginBean.arquis}" var="item">
                            <ui:fragment rendered="#{!item.IsPasta()}">
                            <td class="clickebleTd">
                                <input type="checkbox" style="display:none"></input>
                                <h:commandLink class="select" action="#{loginBean.interacao(item)}" style="display:none" />
                                <h:commandButton class="delete" action="#{loginBean.deleta(item)}" style="display:none" />
                                <img src="img/exts/#{item.getImgPath()}" class="min" alt="" />
                                <div class="arq_name">
                                    #{item.getNome()}
                                </div>
                            </td>
                            </ui:fragment> 
                            </ui:repeat>
                            </h:form>
                        </tr>
                    </tbody>
                </table>
                </div>
            </div>
        </section>
    </section>    
</div>
<script type="text/javascript">//<![CDATA[
    function novoArquivo(){
        document.getElementsByClassName("inputFile")[0].click();
    }
    function novaPasta() {
        var Pasta = prompt("Por favor digite o nome da pasta", "Nova_Pasta");
        if (Pasta != null) {
            Pasta = Pasta.replace(" ","_");
            document.getElementsByClassName("NomePastaAddInput")[0].value=Pasta;
            document.getElementsByClassName("NomePastaAddButton")[0].click();
        }
    }
    var v;
    function clickedTd(x){
        console.log("entrou")
        v=x.target;
        while(!v.classList.contains("clickebleTd")){
            v = v.parentElement;
        }
        radio = v.getElementsByTagName("input")[0];
        if(radio.checked){
            v.children[1].click();
            v.children[0].checked = false;
            v.classList.remove("active");
        }else{
            var oldcheck=document.getElementsByClassName("active");
            while(oldcheck.length>0){
                oldcheck[0].getElementsByTagName("input")[0].checked = false;
                oldcheck[0].classList.remove("active")
            }
            radio.checked = true;
        }
        if(radio.checked){
            v.classList.add("active")
        }else{
            v.classList.remove("active")
        }
        console.log(v);
    }
    var DelPressed = false;
    var clickbleTds=document.getElementsByClassName("clickebleTd");
    for(var i=0;i<clickbleTds.length;i++){
        console.log("ok");
        //clickbleTds[i].onclick = clickedTd(this);
        clickbleTds[i].addEventListener("click", clickedTd)
    }
    document.onkeypress = function(event) {
        var key = event.keyCode || event.charCode;
        if( key == 46 ){
            DelPressed = true;
            console.log("DelDown");
            var oldcheck=document.getElementsByClassName("active");
            if(oldcheck.length>0){
                oldcheck[0].children[2].click();
                oldcheck[0].getElementsByTagName("input")[0].checked = false;
                oldcheck[0].classList.remove("active")
            }
        }
    };
//]]></script>
</body>
</html>